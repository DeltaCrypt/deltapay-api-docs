{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Introduction","text":""},{"location":"#abstract","title":"Abstract","text":"<p>This document acts as a guide for DeltaPay\u2019s open API. It documents the features we expect will be most commonly used by our clients and partners.</p> <p>We firmly believe in open and accessible APIs that anyone can access without additional charges or fees. For this reason, we have decided to make the entire REST interface used by our mobile application accessible to the public. This also means that the API is significantly more extensive than the features highlighted in this document. For a complete list of the endpoints available, please visit:</p> <ul> <li>https://api.dev.deltacrypt.net/docs</li> <li>https://api.beta.deltacrypt.net/docs</li> </ul> <p>to view the auto-generated documentation online for our respective development and production environments.</p>"},{"location":"#environments","title":"Environments","text":"<p>DeltaPay currently offers two mutually exclusive environments: development and production.</p> <p>The development environment is meant for testing and incorporates any additional features or changes to the API that have not yet been published to production. It runs an identical technical setup to the production environment. Still, it does not have to abide by any regulation as the Delta on development is solely for testing and, thus, worthless.</p> <p>We highly recommend testing on the development environment first before connecting to the production endpoints. If API keys are used, DeltaPay reserves the right to test the proposed applications before issuing permissions to the production API keys.</p>"},{"location":"#api-request-guidelines","title":"API Request Guidelines","text":"<p>Unless otherwise specified:</p> <ul> <li>POST requests expect JSON-encoded data.</li> <li>GET and DELETE requests expect URL-encoded data.</li> </ul> <p>All endpoints will return a status code 200 (OK) if no exceptions occur. Other relevant response codes include:</p> <ul> <li>404 - Not Found: The requested resource (e.g., a user) does not exist.</li> <li>401 - Unauthorized: See Authentication Errors.</li> <li>500 - Internal Server Error: Please contact DeltaPay.</li> </ul> <p>All endpoints return JSON-encoded data. If no data is returned, the response will be a generic success object:</p> <pre><code>{\n  \"success\": true\n}\n</code></pre> <p>Unless otherwise specified, this is the default response format.</p>"},{"location":"about/","title":"Dixit gradibus fessa","text":""},{"location":"about/#tantum-quam-istas-capere","title":"Tantum quam istas capere","text":"<p>Lorem markdownum Marte, Aegeus ira miror gratia audire. Herba tela latus meritis sed. Flecti vult potest acer, haec latusque parantem Telamone, mihi veniunt feros nocebant, in. Fugit et umentia diuque sibi cervice fregit; alis amplexo maxima: volucer qui neque Forsitan raptam, sunt ipse.</p> <ol> <li>Gemma nisi crura Pelagonaque servat tua alvo</li> <li>Ante sed aquis non comitata nota</li> <li>Amphion ad caelo collibus</li> <li>Illo habenas</li> <li>Quo Phrygum postquam calathosque autem</li> </ol>"},{"location":"about/#et-arva-et-videt-igni-inde-regni","title":"Et arva et videt igni inde regni","text":"<p>Solacia credere Hippomenen rogus viribus, e dederis data vocat suspicor pelle steterant sanguine: populi re. Relinquit antiquus voce in fuit, ubi et Philomela, magno, et dantur clipeoque sit.</p> <pre><code>and_bit_jsp(multitaskingUnitMedia, pda_mirror(328368 - baudMapMulti),\n        piconetHardClean(irq));\nif (rpm - sink + samplingQbe + sipNocBespoke) {\n    accessRouter = yottabyte;\n} else {\n    wiki += 31;\n    dram += filename + nullGraphic * 5;\n}\nmegabyteSanSector.graphic_format_opengl = -5;\n</code></pre>"},{"location":"about/#vina-mentis-cur-nata-quod-vocesque-et","title":"Vina mentis cur nata quod vocesque et","text":"<p>Et salutem dederat: liliaque ripa hanc procul vertitur sensus arabat: est facta volucrem. Iram novo Euagrum. Patent domus lacus movere doleas; clausit stabantque memor accipitrem ille liventia nunc, nova iaculum?</p> <p>Nec his alto, temptamenta gemitus non deficis in pectore Laertius Achille, oro nec primo in hasta oracula. Credidit e dubitat siccaeque, pulvis. Ligo res! Repleam nisi cum vultibus. Mea virgo, harundine ego trementem Nilum et quid narrat quies; et.</p>"},{"location":"about/#per-aliquid-sudore-vel-longa-cunctaque-carmine","title":"Per aliquid sudore vel longa cunctaque carmine","text":"<p>Laeva Salmacis dum bella; stare montes, erat, postquam. Amor heros non et animosa linguae distent nitido, gravis quo sinumque caelum deum, metum ignoscere capiti sollertius. <pre><code>    if (hard &lt; executableSpooling(cardPartyStorage, site(ddr, jpeg), lock)) {\n        redundancyShell.modelProcessorNntp = megahertz;\n    }\n    if (scalable_pretest_prompt) {\n        facebook_virus_drive(definition_optic, video_asp_ics + 2);\n        cross += record - website_kbps_batch;\n        pci_uri_pdf += management.social_printer(xmpArchitectureFlash, drive);\n    } else {\n        faq_grep_hertz += frequency - video_smb.fiber_markup_macintosh(\n                system_database_uri, byte_utility, 1);\n        asp_intellectual.wimax_motion_link.peopleware(noc_operating_xp, caseUp);\n        ospfMouseSwipe = 3;\n    }\n    address_jre_power += ad_iphone_utility + gigabyte + thin -\n            wavelength_source;\n</code></pre></p> <p>Ardor hos experiensque tempora nequiquam favore falsum iste, munus quid. Legit in urguent, modo non pomo est variarum, vulnere bella supra vigili amabam paternis, iunctissima patiare. Silent filia porrigar simulatque retinacula incursu minuuntur tertia expresso armentis? Vestem cera cetera nata atque mea. Mediis exitioque aliter vivam precaria, cinximus, Caenis veni sine verbaque concutiens.</p> <pre><code>def bar():\n    x = foo()\n    print(\"hello\")\n</code></pre>"},{"location":"authentication/","title":"Authentication","text":"<p>The API uses three ways of authentication: - OAuth 2.0 token - API Key - Blockchain transaction signatures</p> <p>The OAuth 2.0 token and API Key can largely be used interchangeably, whereas functions that entail state changes on the blockchain will generally have to be signed locally by the client.</p> <p>Note: For the endpoints that allow authentication using both the token and API key, either or the other must be passed.</p>"},{"location":"authentication/#oauth-20-token","title":"OAuth 2.0 Token","text":"<p>This form of authentication is designed for individual users. The generated token contains the <code>user_id</code> and can be used to determine the caller without the need to explicitly provide the <code>user_id</code>.</p>"},{"location":"authentication/#login-endpoint","title":"Login Endpoint","text":"<p>The <code>POST /login</code> endpoint expects <code>x-www-form-url-encoded</code> data. This is an exception, as all other POST endpoints expect JSON-encoded data.</p>"},{"location":"authentication/#request-parameters","title":"Request Parameters","text":"<ul> <li><code>username</code>: <code>string</code></li> <li><code>password</code>: <code>string</code></li> </ul>"},{"location":"authentication/#example-response","title":"Example Response","text":"<pre><code>{\n  \"token_type\": \"bearer\",\n  \"access_token\": \"eyJraWQiOiI.......\",\n  \"refresh_token\": \"eyJjdHkiOiJK......\",\n  \"user_id\": 1,\n  \"username\": \"adrian\",\n  \"phone_country_dialcode\": \"268\",\n  \"phone_number\": \"24045443\",\n  \"first_name\": \"Adrian Albert\",\n  \"last_name\": \"Koch\"\n}\n</code></pre> <p>The login endpoint returns two distinct tokens: - <code>access_token</code>: Used to authenticate requests. Generally valid for 15 minutes unless revoked. - <code>refresh_token</code>: Used to obtain a new access token by calling the <code>POST /refresh-access-token</code> endpoint.</p>"},{"location":"authentication/#usage-example","title":"Usage Example","text":"<p>The <code>access_token</code> must be passed as a bearer token in the API request header. Below is an example call to the <code>GET /user</code> endpoint:</p> <pre><code>curl -X 'GET'\n  'https://api.dev.deltacrypt.net/user'\n  -H 'accept: application/json'\n  -H 'Authorization: Bearer eyJraWQi......'\n</code></pre> <p>Note: The <code>user_id</code> does not need to be explicitly passed, as it can be determined from the token. If a value is provided, it will have precedence.</p>"},{"location":"authentication/#api-key","title":"API Key","text":"<p>Authentication using an API token is designed for institutions that want to connect to the API in a programmatic manner. See the API Key Creation section for more detail on how to create and link API tokens.</p> <p>Multiple tokens can be linked to the same legal entity with varying sets of permissions attached to them.</p> <p>The API key must be passed as <code>x-api-key</code> in the API request header. Below is an example call to the <code>GET /user</code> endpoint:</p> <pre><code>curl -X 'GET' \\\n  'https://api.dev.deltacrypt.net/user?user_id=2' \\\n  -H 'accept: application/json' \\\n  -H 'x-api-key: KGD7Wf.....'\n</code></pre> <p>Note: In contrast to the <code>access_token</code> usage, the <code>user_id</code> must be provided in the request as it cannot be determined from the API key.</p>"},{"location":"authentication/#authentication-errors","title":"Authentication Errors","text":"<p>Errors that occur in connection with authentication result in the response code 401 (Unauthorized).</p> <p>The error response will provide details on the type of exception, e.g.</p> <pre><code>{\n  \"detail\": \"Token expired\"\n}\n</code></pre> <p>The following exceptions can occur: - Not authorized - Username or password incorrect - User not confirmed - Username not found - Could not validate credentials - Failed to validate token - Invalid API key - API key has expired - API key has been revoked - Provide either a token or an API key, not both - Either a token or an API key must be provided</p> <p>SignUp:   - Failed   - User not found   - Username not found   - User already registered   - Username already in use   - Password does not meet the requirements   - Confirmation code is incorrect   - Confirmation code has expired   - Attempt limit exceeded</p> <p>Login:   - Failed   - Another challenge is required   - Username not found in the database</p> <p>Refresh Access Token: Failed</p> <p>Forgot Password:   - Failed   - Username not found   - Attempt limit exceeded   - Confirmation code is incorrect   - Confirmation code has expired   - Too many failed attempts   - Password does not meet the requirements</p> <p>Change Password:   - Failed   - Password does not meet the requirements   - Attempt limit exceeded</p> <p>Change Phone Number:   - Failed   - Code is incorrect   - Code has expired   - Attempt limit exceeded</p> <p>Another common cause for an endpoint to return 401 (Unauthorized) is missing permissions, e.g.</p> <pre><code>{\n  \"detail\": \"API key does not have the required permission: view_kyc_data (target_user_id: 2)\"\n}\n</code></pre>"},{"location":"authentication/#blockchain-transaction-signatures","title":"Blockchain Transaction Signatures","text":"<p>The interaction with the blockchain follows three simple steps: 1. Obtain the raw blockchain transaction (generally using one of the GET endpoints prefixed with raw). 2. Sign the transaction locally using the Ethereum wallet previously generated. 3. Optionally query the state of the blockchain transaction.</p> <p>For more details on specific endpoints, please refer to the example attached to this document or contact DeltaPay directly.</p> <p>For the transaction to succeed, the wallet used to sign it must be whitelisted on the blockchain. This requires the caller to provide the public wallet address of the wallet they want to link to the API-key-account (or user-account) pair, which happens implicitly in one of the following ways: - <code>POST /account/link-api-key</code> - <code>POST /account/create-personal</code> - <code>POST /account/register-business</code></p> <p>For the purpose of this document, we focus on the scenario where API keys are used. For more details on linking an API key to an account, refer to Linking API Key in the setup section.</p> <p>Note: Transactions signed by a wallet linked to an API key differ in some ways from those linked to a user. In particular: - API Keys do not have a spending allowance. Therefore, no transaction initiated by an API key will ever need to be approved. - API keys cannot approve other transactions. - API keys cannot set spending allowances. - API keys cannot deactivate accounts.</p> <p>Should you require any of the above features, please contact DeltaPay directly.</p>"},{"location":"c2b/","title":"C2B","text":"<p>The process of receiving money from a customer encompasses the following:</p> <ol> <li>Receive a callback when the transaction status changes (IPN).</li> <li>View the transaction.</li> </ol> <p>We are working on a feature that will allow for prompting the customer to initiate via a notification sent to their device that, when clicked, will pre-fill the send money dialog. Until then, the user must enter the information manually.</p>"},{"location":"c2b/#ipn","title":"IPN","text":"<p>To receive IPNs, the user must first register the base callback URL as described in the Setup section. The callback is triggered for both the sender and recipient accounts using the registered callbacks for the respective accounts, if available. The callback URL format is as follows:</p> <pre><code>base URL + /transaction/status\n</code></pre> <p>The notification payload includes the <code>transaction_id</code> and <code>status</code>. Based on the transaction status, the client can determine whether to retrieve more detailed information about the transaction.</p> <p>Important: This callback is not signed, meaning it could originate from anyone. The user must call <code>GET /full-transaction/from-id</code> to confirm the transaction data.</p>"},{"location":"c2b/#example-callback-body","title":"Example Callback Body","text":"<pre><code>{\n    \"transaction_id\": 42,\n    \"status\": \"succeeded\"\n}\n</code></pre> <p>The following transaction statuses are notified about:</p> <ul> <li>initiated</li> <li>approved</li> <li>succeeded</li> <li>failed</li> </ul> <p>Note: Transactions that do not require approval or finalization will automatically move to the approved or succeeded state. For instance, a bank deposit initiated by a user with sufficient spending allowance will begin in the approved state. Similarly, a transfer that does not require approval will immediately be marked as succeeded.</p>"},{"location":"c2b/#querying-transactions","title":"Querying Transactions","text":""},{"location":"c2b/#get-full-transactionfrom-id","title":"<code>GET /full-transaction/from-id</code>","text":"<p>This endpoint returns all the details on the transaction as opposed to <code>GET accounts/transactions</code>, which returns transactions from the calling account's perspective.</p> <p>The caller can optionally specify the account from whose perspective the amount, fee, and commission will be viewed. To demonstrate this, consider a cash withdrawal of E10. The sender (i.e., the user withdrawing the cash) pays a fee calculated as:</p> \\[ \\text{fee}(x) = 1 + 0.015x \\] <p>and 1% goes as commission to the recipient (i.e., the merchant offering the withdrawal). This will result in the following responses from the endpoint, depending on which account is specified in the <code>caller_account_id</code>:</p> <ul> <li> <p><code>caller_account_id = sender_account_id</code> <pre><code>{\n    \"transaction_id\": 42,\n    ...\n    \"amount\": 10,\n    \"cashback_received\": 0,\n    \"cashback_spent\": 0,\n    \"fee\": 1.15,\n    \"commission_amount\": 0,\n    ...\n}\n</code></pre></p> </li> <li> <p><code>caller_account_id = recipient_account_id</code> <pre><code>{\n    \"transaction_id\": 42,\n    ...\n    \"amount\": 10,\n    \"cashback_received\": 0,\n    \"cashback_spent\": 0,\n    \"fee\": -0.1,\n    \"commission_amount\": 0.1,\n    ...\n}\n</code></pre></p> </li> <li> <p><code>caller_account_id = null</code> <pre><code>{\n    \"transaction_id\": 42,\n    ...\n    \"amount\": 10,\n    \"cashback_received\": 0,\n    \"cashback_spent\": 0,\n    \"fee\": 1.05,\n    \"commission_amount\": 0.1,\n    ...\n}\n</code></pre></p> </li> </ul>"},{"location":"c2b/#request-parameters","title":"Request Parameters","text":"<ul> <li><code>transaction_id</code>: <code>number</code></li> <li><code>caller_account_id</code>: <code>Optional[number]</code></li> </ul>"},{"location":"c2b/#required-permissions","title":"Required Permissions","text":"<p>The caller must have the <code>view_transactions</code> permission, either generally or specifically for the sender or recipient account. Furthermore, the user's permissions and their potential attachment as an employee to the accounts involved in the transaction will determine whether they can see details on the initiator, approver, and finalizer.</p> example_response.json<pre><code>{\n  \"transaction_id\": 42,\n  \"transaction_type\": \"cash_withdrawal\",\n  \"transaction_status\": \"succeeded\",\n  \"initialisation_time\": \"2024-07-15T19:11:07.247411\",\n  \"settled_time\": \"2024-07-15T19:11:11.890845\",\n  \"note\": \"hello world + metadata\",\n  \"source_of_funds\": \"\",\n  \"bank_account\": null,\n  \"sender_account_id\": 123,\n  \"sender_account_name\": \"Personal\",\n  \"sender_name\": \"adrian\",\n  \"sender_till_name\": null,\n  \"recipient_account_id\": 60,\n  \"recipient_account_name\": \"Mbabane Office\",\n  \"recipient_name\": \"DeltaPay\",\n  \"recipient_till_name\": \"Desk 1\",\n  \"amount\": 10,\n  \"cashback_received\": 0,\n  \"cashback_spent\": 0,\n  \"fee\": 1.05,\n  \"commission_amount\": 0.1,\n  \"initiator\": {\n    \"username\": \"adrian\",\n    \"legal_name\": \"Adrian Albert Koch\"\n  },\n  \"approver\": null,\n  \"finaliser\": null\n}\n</code></pre>"},{"location":"permissions/","title":"Permissions","text":"<p>The permissions for accessing non-blockchain functions are organized as follows:</p> <ul> <li>General Permissions: These apply broadly across the system.</li> <li>Targeted Permissions: These apply to specific targets, in particular:</li> <li>User</li> <li>Account</li> <li>Legal Entity</li> </ul> <p>Note: No permissions are needed when a <code>UserTargetPermission</code> is required and the caller is the target user. This allows users to request their own data without requiring specific permissions. Any exceptions to this rule will be clearly stated.</p>"},{"location":"permissions/#roles","title":"Roles","text":"<p>General permissions can be attached to a role, which may then be assigned to a user or API key. This allows for logical grouping of permissions and avoids having to assign them individually.</p> <p>Note: Permissions assigned to a role are always general (they do not apply to a specific target).</p>"},{"location":"permissions/#user-and-api-key-permissions","title":"User and API Key Permissions","text":"<p>There are two types of callers:</p> <ul> <li>Users: Who will typically authenticate using an OAuth token.</li> <li>Servers: Which will typically authenticate using an API key.</li> </ul> <p>Both users and API keys can have permissions assigned to them and provide a cognate set of endpoints to grant, view, and revoke roles and permissions respectively. For users there is:</p> <ul> <li><code>POST /user/grant-role</code></li> <li><code>POST /user/grant-account-permissions</code></li> <li><code>POST /user/grant-user-permissions</code></li> <li><code>POST /user/grant-legal-entity-permissions</code></li> <li><code>GET /user/roles</code></li> <li><code>GET /user/permissions</code></li> <li><code>DELETE /user/revoke-role</code></li> <li><code>DELETE /user/revoke-account-permissions</code></li> <li><code>DELETE /user/revoke-user-permissions</code></li> <li><code>DELETE /user/revoke-legal-entity-permissions</code></li> </ul> <p>For API keys there is:</p> <ul> <li><code>POST /api-key/grant-role</code></li> <li><code>POST /api-key/grant-account-permissions</code></li> <li><code>POST /api-key/grant-user-permissions</code></li> <li><code>POST /api-key/grant-legal-entity-permissions</code></li> <li><code>GET /api-key/roles</code></li> <li><code>GET /api-key/permissions</code></li> <li><code>DELETE /api-key/revoke-role</code></li> <li><code>DELETE /api-key/revoke-account-permissions</code></li> <li><code>DELETE /api-key/revoke-user-permissions</code></li> <li><code>DELETE /api-key/revoke-legal-entity-permissions</code></li> </ul> <p>For more detailed documentation on the endpoints above, please refer to the online documentation. For demonstration purposes, we will highlight the following:</p>"},{"location":"permissions/#post-usergrant-account-permissions","title":"<code>POST /user/grant-account-permissions</code>","text":"<p>Multiple permissions can be granted for the same user and target account. This is common because, for instance, an account admin gains many permissions simultaneously when assigned the admin role. Different account targets will require separate calls.</p> <p>Note: Granting a permission twice will not throw an error, but simply be ignored.</p>"},{"location":"permissions/#request-parameters","title":"Request Parameters","text":"<ul> <li><code>subject_user_id</code>: <code>number</code></li> <li><code>permissions</code>: <code>Array[string]</code></li> <li><code>target_account_id</code>: <code>number</code></li> </ul>"},{"location":"permissions/#required-permissions","title":"Required Permissions","text":"<p>The caller must have the general <code>grant_account_permission</code> permission.</p>"},{"location":"permissions/#get-userpermissions","title":"<code>GET /user/permissions</code>","text":""},{"location":"permissions/#request-parameters_1","title":"Request Parameters","text":"<ul> <li><code>user_id</code>: <code>Optional[number]</code></li> </ul> <p>If the <code>user_id</code> is not provided and the caller uses an OAuth token to authenticate the call, it can be determined from the token.</p>"},{"location":"permissions/#required-permissions_1","title":"Required Permissions","text":"<p>The caller must have the <code>view_permissions</code> permission, either generally or specifically for the user. As described at the beginning of the Permissions chapter, users do not need any permissions to view their own data.</p>"},{"location":"permissions/#example-response","title":"Example Response","text":"<pre><code>{\n    {\n      \"permission\": \"view_spending_allowance\",\n      \"target_type\": \"general\"\n    },\n    ...\n    {\n      \"permission\": \"view_transactions\",\n      \"target_type\": \"general\"\n    },\n    {\n      \"permission\": \"view_account_info\",\n      \"target_type\": \"account_list\",\n      \"target_account_ids\": [\n        1001,\n        1004,\n        1006\n      ]\n    },\n    ...\n</code></pre>"},{"location":"permissions/#delete-userrevoke-account-permissions","title":"<code>DELETE /user/revoke-account-permissions</code>","text":"<p>This endpoint can be used to revoke either a specific or all permission(s) for a certain user or target account.</p>"},{"location":"permissions/#request-parameters_2","title":"Request Parameters","text":"<ul> <li><code>subject_user_id</code>: <code>number</code></li> <li><code>target_account_id</code>: <code>number</code></li> <li><code>permissions</code>: <code>Optional[string]</code></li> </ul> <p>If permission is null, all permissions are revoked for the target account.</p>"},{"location":"permissions/#required-permissions_2","title":"Required Permissions","text":"<p>The caller must have the general <code>revoke_account_permission</code> permission.</p>"},{"location":"setup/","title":"Setup","text":""},{"location":"setup/#client-onboarding","title":"Client Onboarding","text":"<p>The client must be fully onboarded before any API integration can take place. This involves the collection and review of the client's documents as well as the account creation process. Please refer to the DeltaPay terms and conditions for more information. In particular, this process involves the following: - DeltaPay creates the legal entity in the system - Client submits a resolution to create the business account(s) and define the AAAs - DeltaPay creates and sets up the account(s) as specified in the resolution</p>"},{"location":"setup/#api-key-creation","title":"API Key Creation","text":"<p>Once the client onboarding and account setup are complete, the API keys can be generated. This process can either be completed by the client himself or by DeltaPay on his behalf. The following points are worth considering:</p> <ul> <li>If the client chooses to generate the keys himself, at least one user who is registered with DeltaPay and employed or trusted by the client should be granted the following permissions:</li> <li><code>create_api_key</code></li> <li><code>view_api_keys</code></li> <li><code>revoke_api_key</code></li> </ul> <p>For example, these permissions may be granted to one of the AAAs.</p> <ul> <li>If DeltaPay generates the API key on behalf of the client, the generated key must be shared with the client via traditional channels, such as email, which may not satisfy the client's security requirements.</li> </ul> <p>If the client decides to generate the key(s) himself, he must call the following endpoint:</p>"},{"location":"setup/#post-legal-entityapi-keycreate","title":"<code>POST /legal-entity/api-key/create</code>","text":"<p>API keys are valid for five years and can be named to differentiate between them easily. They are attached to the legal entity that was specified when generating them.</p> <p>The generated key is only visible once upon creation; it is the client's responsibility to store and manage it securely.</p>"},{"location":"setup/#request-parameters","title":"Request Parameters","text":"<ul> <li><code>legal_entity_id</code>: <code>number</code></li> <li><code>name</code>: <code>string</code></li> </ul>"},{"location":"setup/#required-permissions","title":"Required Permissions","text":"<p>The caller must have the <code>create_api_key</code> permission, either generally or specifically for the targeted legal entity ID.</p> <pre><code>{\n  \"api_key_id\": 4,\n  \"legal_entity_id\": 1,\n  \"prefix\": \"9tsIF\",\n  \"name\": \"test\",\n  \"active\": true,\n  \"creation_time\": \"2024-07-17T17:01:50.837261\",\n  \"expiration_time\": \"2029-07-16T17:01:50.833435\",\n  \"api_key\": \"9tsIFO4XJA-viHR4ga8AW_aixe7mH7IblnB2pNjukYo\"\n}\n</code></pre> <p>After the API key has been created, DeltaPay will grant it permissions based on the client's requirements. Please refer to the Permissions chapter for more information.</p>"},{"location":"setup/#get-legal-entityapi-keys","title":"<code>GET /legal-entity/api-keys</code>","text":"<p>Returns the API keys attached to a legal entity.</p>"},{"location":"setup/#request-parameters_1","title":"Request Parameters","text":"<ul> <li><code>legal_entity_id</code>: <code>number</code></li> </ul>"},{"location":"setup/#required-permissions_1","title":"Required Permissions","text":"<p>The caller must have the <code>view_api_keys</code> permission, either generally or specifically for the targeted legal entity.</p> <pre><code>{\n  \"api_keys\": [\n    {\n      \"api_key_id\": 1,\n      \"legal_entity_id\": 1,\n      \"prefix\": \"OyDH-\",\n      \"name\": \"test\",\n      \"active\": false,\n      \"creation_time\": \"2024-07-12T10:32:30.553105\",\n      \"expiration_time\": \"2029-07-11T10:32:30.543345\"\n    },\n    ...\n    {\n      \"api_key_id\": 4,\n      \"legal_entity_id\": 1,\n      \"prefix\": \"9tsIF\",\n      \"name\": \"test\",\n      \"active\": true,\n      \"creation_time\": \"2024-07-17T17:01:50.837261\",\n      \"expiration_time\": \"2029-07-16T17:01:50.833435\"\n    }\n  ]\n}\n</code></pre> <p>Note how the API key with <code>id</code> 4 we previously created only returns the prefix and name but not the full key.</p>"},{"location":"setup/#delete-legal-entityapi-keyrevoke","title":"<code>DELETE legal-entity/api-key/revoke</code>","text":"<p>API keys can be revoked prior to their expiry date. It is crucial to revoke keys immediately that are suspected to have been leaked. Revoked keys cannot be reactivated.</p>"},{"location":"setup/#request-parameters_2","title":"Request Parameters","text":"<ul> <li><code>api_key_id</code>: <code>number</code></li> </ul>"},{"location":"setup/#required-permissions_2","title":"Required Permissions","text":"<p>The caller must have the <code>revoke_api_key</code> permission, either generally or specifically for the legal entity that the key is linked to.</p>"},{"location":"setup/#linking-api-key","title":"Linking API Key","text":"<p>As mentioned in Blockchain Transaction Signatures, the user must link the wallet address and account and either user or API key in order to use for it to be whitelisted on the blockchain.</p> <p>Please refer to the code example for more details on this process.</p> <p>In the case of API keys, this is achieved by calling the following endpoint:</p>"},{"location":"setup/#post-accountlink-api-key","title":"<code>POST /account/link-api-key</code>","text":"<p>If the API key is already linked to the account, calling this endpoint will update the wallet address. This has the same effect as unlinking and relinking with while providing a different wallet address.</p>"},{"location":"setup/#request-parameters_3","title":"Request Parameters","text":"<ul> <li><code>api_key_id</code>: <code>number</code></li> <li><code>account_id</code>: <code>number</code></li> <li><code>wallet_address</code>: <code>string</code></li> </ul>"},{"location":"setup/#required-permissions_3","title":"Required Permissions","text":"<p>The caller must have the <code>link_api_key_to_account</code> permission, either generally or specifically for the account that the key is being linked to.</p>"},{"location":"setup/#post-accountunlink-api-key","title":"<code>POST /account/unlink-api-key</code>","text":"<p>API keys can be unlinked again. The wallet address that was provided when linking the key will be removed from the whitelist and added to the list of deactivated wallet addresses for the account-API-key pair.</p> <p>Important: Immediately unlink (or update) the API key if there is suspicion that the private key matching the wallet address linked to the account has been leaked. After unlinking the key, the same key can be linked again while providing a different wallet address (of a newly generated wallet). Alternatively, <code>POST /account/link-api-key</code> can be called directly with the new wallet address. This has the same effect as unlinking and relinking.</p>"},{"location":"setup/#request-parameters_4","title":"Request Parameters","text":"<ul> <li><code>api_key_id</code>: <code>number</code></li> <li><code>account_id</code>: <code>number</code></li> </ul>"},{"location":"setup/#required-permissions_4","title":"Required Permissions","text":"<p>The caller must have the <code>unlink_api_key_to_account</code> permission, either generally or specifically for the account that the key is being unlinked from.</p>"},{"location":"setup/#callback-registration","title":"Callback Registration","text":"<p>The user can register callbacks for a number of events that occur on the DeltaPay system. To ensure easy extensibility, the user only registers the base URL to which he wants the callback requests sent to.</p> <p>For example, if the callback endpoint is <code>api.client.co.sz</code>, the IPN callback will call <code>POST api.client.co.sz/transaction/status</code>.</p> <p>The following endpoints are for setting, viewing, and deactivating the callback URL for a specific account.</p>"},{"location":"setup/#post-accountcallback-urlset","title":"<code>POST /account/callback-url/set</code>","text":""},{"location":"setup/#request-parameters_5","title":"Request Parameters","text":"<ul> <li><code>account_id</code>: <code>number</code></li> </ul>"},{"location":"setup/#required-permissions_5","title":"Required Permissions","text":"<p>The caller must have the <code>set_callback_url</code> permission, either generally or specifically for the account that the callback URL is set for.</p>"},{"location":"setup/#get-accountcallback-url","title":"<code>GET /account/callback-url</code>","text":""},{"location":"setup/#request-parameters_6","title":"Request Parameters","text":"<ul> <li><code>account_id</code>: <code>number</code></li> </ul>"},{"location":"setup/#required-permissions_6","title":"Required Permissions","text":"<p>The caller must have the <code>view_callback_url</code> permission, either generally or specifically for the account.</p>"},{"location":"setup/#example-response","title":"Example Response","text":"<pre><code>{\n  \"callback_url\": \"https://api.client.co.sz\"\n}\n</code></pre>"},{"location":"setup/#delete-accountcallback-urldeactivate","title":"<code>DELETE /account/callback-url/deactivate</code>","text":"<p>Sets the callback URL to null so that no more callbacks will be called for events related to this account.</p>"},{"location":"setup/#request-parameters_7","title":"Request Parameters","text":"<ul> <li><code>account_id</code>: <code>number</code></li> </ul>"},{"location":"setup/#required-permissions_7","title":"Required Permissions","text":"<p>The caller must have the <code>set_callback_url</code> permission, either generally or specifically for the account for which the callback URL is being deactivated.</p>"}]}